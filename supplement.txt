# ğŸš€ å­¦ç”Ÿå…¬å¯“äº¤è´¹ç®¡ç†ç³»ç»Ÿ - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ“ å®Œæ•´é¡¹ç›®ç»“æ„

```
dorm_management/
â”‚
â”œâ”€â”€ app.py                      # Flaskåº”ç”¨ä¸»æ–‡ä»¶ â­
â”œâ”€â”€ config.py                   # é…ç½®æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ database.sql                # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ â­
â”œâ”€â”€ requirements.txt            # Pythonä¾èµ–æ¸…å• â­
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”‚
â”œâ”€â”€ templates/                  # HTMLæ¨¡æ¿ç›®å½• â­
â”‚   â”œâ”€â”€ base.html              # åŸºç¡€æ¨¡æ¿ï¼ˆå¯¼èˆªæ ï¼‰
â”‚   â”œâ”€â”€ login.html             # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ dashboard.html         # ä»ªè¡¨æ¿
â”‚   â”œâ”€â”€ students.html          # å­¦ç”Ÿç®¡ç†
â”‚   â”œâ”€â”€ buildings.html         # å…¬å¯“æ¥¼ç®¡ç†
â”‚   â”œâ”€â”€ rooms.html             # å¯å®¤ç®¡ç†
â”‚   â”œâ”€â”€ payments.html          # äº¤è´¹ç®¡ç†
â”‚   â”œâ”€â”€ reports.html           # ç»Ÿè®¡æŠ¥è¡¨
â”‚   â””â”€â”€ users.html             # ç”¨æˆ·ç®¡ç†
â”‚
â”œâ”€â”€ static/                     # é™æ€æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ js/
â”‚   â””â”€â”€ images/
â”‚
â”œâ”€â”€ logs/                       # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ access.log
â”‚   â””â”€â”€ error.log
â”‚
â”œâ”€â”€ backups/                    # æ•°æ®åº“å¤‡ä»½ç›®å½•
â”‚
â”œâ”€â”€ venv/                       # Pythonè™šæ‹Ÿç¯å¢ƒï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ start.sh                    # Linux/Macå¯åŠ¨è„šæœ¬
â”œâ”€â”€ start.bat                   # Windowså¯åŠ¨è„šæœ¬
â””â”€â”€ .env                        # ç¯å¢ƒå˜é‡é…ç½®ï¼ˆä¸æäº¤ï¼‰
```

**â­æ ‡è®°çš„æ˜¯å¿…éœ€æ–‡ä»¶**

---

## âš¡ 5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²

### æ–¹æ³•ä¸€ï¼šæ‰‹åŠ¨å®‰è£…ï¼ˆæ¨èï¼‰

#### æ­¥éª¤1ï¼šå‡†å¤‡ç¯å¢ƒ
```bash
# ç¡®è®¤Pythonç‰ˆæœ¬ï¼ˆéœ€è¦3.7+ï¼‰
python --version

# ç¡®è®¤MySQLå·²å®‰è£…å¹¶å¯åŠ¨
mysql --version
```

#### æ­¥éª¤2ï¼šåˆ›å»ºé¡¹ç›®ç›®å½•
```bash
# åˆ›å»ºå¹¶è¿›å…¥é¡¹ç›®ç›®å½•
mkdir dorm_management
cd dorm_management

# åˆ›å»ºtemplatesç›®å½•
mkdir templates
```

#### æ­¥éª¤3ï¼šä¿å­˜æ–‡ä»¶
å°†ä»¥ä¸‹æ–‡ä»¶ä¿å­˜åˆ°ç›¸åº”ä½ç½®ï¼š
- âœ… `app.py` â†’ é¡¹ç›®æ ¹ç›®å½•
- âœ… `database.sql` â†’ é¡¹ç›®æ ¹ç›®å½•
- âœ… `requirements.txt` â†’ é¡¹ç›®æ ¹ç›®å½•
- âœ… æ‰€æœ‰HTMLæ¨¡æ¿ â†’ `templates/` ç›®å½•

#### æ­¥éª¤4ï¼šåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate
```

#### æ­¥éª¤5ï¼šå®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

**å¦‚æœå®‰è£…mysqlclientå¤±è´¥ï¼š**
- Windows: ä¸‹è½½wheelæ–‡ä»¶ https://www.lfd.uci.edu/~gohlke/pythonlibs/#mysqlclient
- æˆ–ä½¿ç”¨: `pip install pymysql` å¹¶åœ¨app.pyé¡¶éƒ¨æ·»åŠ ï¼š
  ```python
  import pymysql
  pymysql.install_as_MySQLdb()
  ```

#### æ­¥éª¤6ï¼šåˆå§‹åŒ–æ•°æ®åº“
```bash
# æ–¹æ³•1ï¼šå‘½ä»¤è¡Œå¯¼å…¥
mysql -u root -p < database.sql

# æ–¹æ³•2ï¼šMySQLå®¢æˆ·ç«¯
mysql -u root -p
> source /path/to/database.sql
> exit
```

#### æ­¥éª¤7ï¼šé…ç½®åº”ç”¨
ç¼–è¾‘ `app.py`ï¼Œä¿®æ”¹æ•°æ®åº“é…ç½®ï¼š
```python
app.config['MYSQL_HOST'] = 'localhost'
app.config['MYSQL_USER'] = 'root'
app.config['MYSQL_PASSWORD'] = 'ä½ çš„æ•°æ®åº“å¯†ç '  # â† ä¿®æ”¹è¿™é‡Œ
app.config['MYSQL_DB'] = 'dorm_management'
```

#### æ­¥éª¤8ï¼šå¯åŠ¨åº”ç”¨
```bash
python app.py
```

è®¿é—®ï¼šhttp://localhost:5000

---

### æ–¹æ³•äºŒï¼šDockeréƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

åˆ›å»º `Dockerfile`:
```dockerfile
FROM python:3.9-slim

WORKDIR /app

# å®‰è£…MySQLå®¢æˆ·ç«¯ä¾èµ–
RUN apt-get update && apt-get install -y \
    default-libmysqlclient-dev \
    gcc \
    && rm -rf /var/lib/apt/lists/*

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 5000

CMD ["python", "app.py"]
```

åˆ›å»º `docker-compose.yml`:
```yaml
version: '3.8'

services:
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: root_password
      MYSQL_DATABASE: dorm_management
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql
      - ./database.sql:/docker-entrypoint-initdb.d/init.sql

  web:
    build: .
    ports:
      - "5000:5000"
    environment:
      MYSQL_HOST: mysql
      MYSQL_USER: root
      MYSQL_PASSWORD: root_password
      MYSQL_DB: dorm_management
    depends_on:
      - mysql

volumes:
  mysql_data:
```

å¯åŠ¨ï¼š
```bash
docker-compose up -d
```

---

## ğŸ” é¦–æ¬¡ç™»å½•

è®¿é—® http://localhost:5000

**é»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼š**
- ç”¨æˆ·åï¼š`admin`
- å¯†ç ï¼š`admin123`

**å…¶ä»–æµ‹è¯•è´¦å·ï¼š**
- `teacher1` / `admin123` (æ•™å¸ˆæƒé™)
- `teacher2` / `admin123` (æ•™å¸ˆæƒé™)

âš ï¸ **é‡è¦ï¼šç™»å½•åç«‹å³ä¿®æ”¹å¯†ç ï¼**

---

## ğŸ“‹ åŠŸèƒ½æ¸…å•

### âœ… å·²å®ç°åŠŸèƒ½

| æ¨¡å— | åŠŸèƒ½ | è¯´æ˜ |
|-----|------|------|
| **ç”¨æˆ·è®¤è¯** | ç™»å½•/ç™»å‡º | Sessionç®¡ç†ï¼Œå¯†ç åŠ å¯† |
| | æƒé™æ§åˆ¶ | ç®¡ç†å‘˜/æ•™å¸ˆåˆ†çº§æƒé™ |
| **å­¦ç”Ÿç®¡ç†** | CRUDæ“ä½œ | å¢åˆ æ”¹æŸ¥ |
| | æœç´¢ç­›é€‰ | å¤šæ¡ä»¶æœç´¢ |
| | å¯å®¤åˆ†é… | è‡ªåŠ¨éªŒè¯å®¹é‡ |
| **å…¬å¯“æ¥¼ç®¡ç†** | æ¥¼æ ‹ç»´æŠ¤ | åŸºæœ¬ä¿¡æ¯ç®¡ç† |
| | ç»Ÿè®¡å±•ç¤º | å…¥ä½æƒ…å†µç»Ÿè®¡ |
| **å¯å®¤ç®¡ç†** | å¯å®¤ç»´æŠ¤ | è´¹ç”¨ã€å®¹é‡è®¾ç½® |
| | å…¥ä½ç‡æ˜¾ç¤º | å¯è§†åŒ–è¿›åº¦æ¡ |
| **äº¤è´¹ç®¡ç†** | äº¤è´¹ç™»è®° | æ”¯æŒå¤šç§ç±»å‹ |
| | è®°å½•æŸ¥è¯¢ | å¤šç»´åº¦ç­›é€‰ |
| | æ•°æ®ç»Ÿè®¡ | é‡‘é¢æ±‡æ€» |
| **ç»Ÿè®¡æŠ¥è¡¨** | æœˆåº¦ç»Ÿè®¡ | å›¾è¡¨å±•ç¤ºè¶‹åŠ¿ |
| | ä¸“ä¸šç»Ÿè®¡ | å„ä¸“ä¸šæ”¶è´¹æƒ…å†µ |
| | æ¬ è´¹æé†’ | è‡ªåŠ¨è®¡ç®—æ¬ è´¹ |
| **ç³»ç»Ÿç®¡ç†** | ç”¨æˆ·ç®¡ç† | æ·»åŠ åˆ é™¤ç”¨æˆ· |
| | æƒé™åˆ†é… | ç®¡ç†å‘˜ä¸“å± |

---

## ğŸ¯ ä½¿ç”¨æµç¨‹ç¤ºä¾‹

### åœºæ™¯1ï¼šæ–°å­¦æœŸå¼€å­¦ï¼Œå½•å…¥å­¦ç”Ÿä¿¡æ¯

1. ç™»å½•ç³»ç»Ÿï¼ˆadmin / admin123ï¼‰
2. ç‚¹å‡»"å­¦ç”Ÿç®¡ç†"
3. ç‚¹å‡»"æ·»åŠ å­¦ç”Ÿ"
4. å¡«å†™å­¦ç”Ÿä¿¡æ¯ï¼Œé€‰æ‹©å¯å®¤
5. æäº¤ä¿å­˜

### åœºæ™¯2ï¼šå­¦ç”Ÿäº¤ä½å®¿è´¹

1. ç‚¹å‡»"äº¤è´¹ç®¡ç†"
2. ç‚¹å‡»"æ–°å¢äº¤è´¹"
3. é€‰æ‹©å­¦ç”Ÿ
4. é€‰æ‹©"ä½å®¿è´¹"ï¼Œå¡«å†™é‡‘é¢
5. é€‰æ‹©äº¤è´¹æ—¥æœŸï¼Œæäº¤

### åœºæ™¯3ï¼šæŸ¥çœ‹æœ¬æœˆæ”¶è´¹ç»Ÿè®¡

1. ç‚¹å‡»"ä»ªè¡¨æ¿"
2. æŸ¥çœ‹"æœ¬æœˆæ”¶è´¹"å¡ç‰‡
3. æˆ–ç‚¹å‡»"ç»Ÿè®¡æŠ¥è¡¨"æŸ¥çœ‹è¯¦ç»†æ•°æ®

### åœºæ™¯4ï¼šæ·»åŠ æ–°ç”¨æˆ·

1. ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•
2. ç‚¹å‡»"ç”¨æˆ·ç®¡ç†"
3. ç‚¹å‡»"æ·»åŠ ç”¨æˆ·"
4. å¡«å†™ç”¨æˆ·ä¿¡æ¯ï¼Œé€‰æ‹©æƒé™
5. æäº¤ä¿å­˜

---

## ğŸ”§ å¸¸è§é…ç½®è°ƒæ•´

### ä¿®æ”¹ç«¯å£
ç¼–è¾‘ `app.py` æœ€åä¸€è¡Œï¼š
```python
app.run(debug=True, host='0.0.0.0', port=8080)  # æ”¹ä¸º8080
```

### ä¿®æ”¹åˆ†é¡µæ•°é‡
ç¼–è¾‘ `app.py` ä¸­çš„ `per_page` å˜é‡ï¼š
```python
per_page = 20  # æ¯é¡µæ˜¾ç¤º20æ¡
```

### å¯ç”¨HTTPS
```python
if __name__ == '__main__':
    app.run(
        debug=False,
        host='0.0.0.0',
        port=443,
        ssl_context=('cert.pem', 'key.pem')
    )
```

### ä¿®æ”¹Sessionè¶…æ—¶æ—¶é—´
åœ¨ `app.py` æ·»åŠ ï¼š
```python
from datetime import timedelta
app.permanent_session_lifetime = timedelta(hours=2)
```

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šæ— æ³•è¿æ¥æ•°æ®åº“
**é”™è¯¯ä¿¡æ¯**: `Can't connect to MySQL server`

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥MySQLæœåŠ¡æ˜¯å¦å¯åŠ¨
   ```bash
   # Linux
   sudo systemctl status mysql

   # Windows
   services.msc â†’ æŸ¥æ‰¾MySQLæœåŠ¡
   ```
2. æ£€æŸ¥ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å·²åˆ›å»º
   ```sql
   SHOW DATABASES LIKE 'dorm_management';
   ```

### é—®é¢˜2ï¼šé¡µé¢æ˜¾ç¤º404
**åŸå› **: æ¨¡æ¿æ–‡ä»¶è·¯å¾„é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤ `templates/` ç›®å½•å­˜åœ¨
2. ç¡®è®¤æ‰€æœ‰HTMLæ–‡ä»¶å·²ä¿å­˜åˆ° `templates/` ç›®å½•
3. æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦æ­£ç¡®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰

### é—®é¢˜3ï¼šä¸­æ–‡ä¹±ç 
**è§£å†³æ–¹æ¡ˆ**:
1. æ•°æ®åº“ç¼–ç æ”¹ä¸ºUTF-8:
   ```sql
   ALTER DATABASE dorm_management CHARACTER SET utf8mb4;
   ```
2. ç¡®ä¿æ‰€æœ‰æ–‡ä»¶ä¿å­˜ä¸ºUTF-8ç¼–ç 

### é—®é¢˜4ï¼šå¯¼å…¥mysqlclientå¤±è´¥
**Windowsè§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ³•1ï¼šä¸‹è½½wheelæ–‡ä»¶
pip install mysqlclient-xxx-win_amd64.whl

# æ–¹æ³•2ï¼šä½¿ç”¨PyMySQL
pip install pymysql
```

åœ¨ `app.py` é¡¶éƒ¨æ·»åŠ ï¼š
```python
import pymysql
pymysql.install_as_MySQLdb()
```

### é—®é¢˜5ï¼šç«¯å£è¢«å ç”¨
**é”™è¯¯ä¿¡æ¯**: `Address already in use`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
# Linux/Mac
lsof -i :5000

# Windows
netstat -ano | findstr :5000

# ç»“æŸè¿›ç¨‹æˆ–æ›´æ”¹ç«¯å£
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### æ•°æ®åº“ä¼˜åŒ–
```sql
-- æ·»åŠ ç´¢å¼•
CREATE INDEX idx_payment_date ON payments(payment_date);
CREATE INDEX idx_student_major ON students(major);

-- å®šæœŸä¼˜åŒ–è¡¨
OPTIMIZE TABLE students, payments, rooms;
```

### åº”ç”¨ä¼˜åŒ–
```python
# å¯ç”¨æ•°æ®åº“è¿æ¥æ± 
app.config['MYSQL_POOL_SIZE'] = 10
app.config['MYSQL_POOL_RESET_SESSION'] = True

# å¯ç”¨ç¼“å­˜ï¼ˆéœ€å®‰è£…flask-cachingï¼‰
from flask_caching import Cache
cache = Cache(app, config={'CACHE_TYPE': 'simple'})
```

---

## ğŸ“š æ‰©å±•å¼€å‘

### æ·»åŠ æ–°åŠŸèƒ½æ¨¡å—

1. **å®šä¹‰è·¯ç”±**ï¼ˆapp.pyï¼‰:
```python
@app.route('/custom_feature')
@login_required
def custom_feature():
    # ä¸šåŠ¡é€»è¾‘
    return render_template('custom.html')
```

2. **åˆ›å»ºæ¨¡æ¿**ï¼ˆtemplates/custom.htmlï¼‰:
```html
{% extends "base.html" %}
{% block content %}
<!-- é¡µé¢å†…å®¹ -->
{% endblock %}
```

3. **æ·»åŠ å¯¼èˆªé“¾æ¥**ï¼ˆtemplates/base.htmlï¼‰:
```html
<li class="nav-item">
    <a class="nav-link" href="{{ url_for('custom_feature') }}">
        æ–°åŠŸèƒ½
    </a>
</li>
```

---

## ğŸ”’ å®‰å…¨æ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰ç¡®è®¤ï¼š

- [ ] ä¿®æ”¹äº†é»˜è®¤å¯†é’¥ `SECRET_KEY`
- [ ] ä¿®æ”¹äº†æ‰€æœ‰é»˜è®¤å¯†ç 
- [ ] å…³é—­äº†è°ƒè¯•æ¨¡å¼ `DEBUG=False`
- [ ] é…ç½®äº†é˜²ç«å¢™è§„åˆ™
- [ ] å¯ç”¨äº†HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- [ ] è®¾ç½®äº†æ•°æ®åº“å¼ºå¯†ç 
- [ ] é™åˆ¶äº†æ•°æ®åº“è®¿é—®IP
- [ ] å®šæœŸå¤‡ä»½æ•°æ®åº“
- [ ] æ›´æ–°äº†ç³»ç»Ÿå’Œä¾èµ–åŒ…

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æŸ¥çœ‹æ—¥å¿—**: æ£€æŸ¥ç»ˆç«¯è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯
2. **æ£€æŸ¥é…ç½®**: ç¡®è®¤æ•°æ®åº“è¿æ¥é…ç½®æ­£ç¡®
3. **æŸ¥çœ‹æ–‡æ¡£**: é˜…è¯»éƒ¨ç½²è¯´æ˜æ–‡æ¡£
4. **æµ‹è¯•è¿æ¥**: å•ç‹¬æµ‹è¯•MySQLè¿æ¥

---

## ğŸ‰ æ€»ç»“

æœ¬ç³»ç»Ÿæä¾›äº†å®Œæ•´çš„å­¦ç”Ÿå…¬å¯“ç®¡ç†è§£å†³æ–¹æ¡ˆï¼š
- âœ… å¼€ç®±å³ç”¨ï¼Œ5åˆ†é’Ÿéƒ¨ç½²
- âœ… ç•Œé¢å‹å¥½ï¼Œå“åº”å¼è®¾è®¡
- âœ… åŠŸèƒ½å®Œæ•´ï¼Œæ»¡è¶³æ—¥å¸¸éœ€æ±‚
- âœ… ä»£ç è§„èŒƒï¼Œæ˜“äºæ‰©å±•
- âœ… åŒ…å«ç¤ºä¾‹æ•°æ®ï¼Œå¿«é€Ÿä¸Šæ‰‹

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€

---

## ç‰ˆæœ¬ä¿¡æ¯
- **ç³»ç»Ÿç‰ˆæœ¬**: v1.0
- **æ›´æ–°æ—¥æœŸ**: 2024
- **Python**: 3.7+
- **Flask**: 2.3.3
- **MySQL**: 5.7+
- **Bootstrap**: 5.3.0